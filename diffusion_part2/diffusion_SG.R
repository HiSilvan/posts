##################################################################
##################################################################
##################################################################

# load libraries
library(tidyverse)
library(lubridate)
library(rstan)
rstan_options(auto_write = TRUE)

# model
source("diffusion_SG_funcs.R")

##################################################################
##################################################################
##################################################################

# simulate data
set.seed(2015)
dta <- simulate_dta()

ggplot(aes(x = date, y = S_t), data = dta) + 
  geom_line() + 
  theme_classic() + 
  ggtitle("Search term popularity")

##################################################################
##################################################################
##################################################################

res <- sg_diffusion(date = dta$date, x = dta$S_t)
summary(res)

traceplot(res$fit, pars = c("m", "p", "q", "sigma"))
plot(res)

##################################################################
##################################################################
##################################################################
